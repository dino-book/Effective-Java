## 57 지역변수의 범위를 최소화하라

기본적으로 "클래스와 멤버의 접근 권한을 최소화하라"라고 한 아이템 15와 취지가 비슷하다. 지역변수의 유효 범위를 최소로 줄이면 코드 가독성과 유지보수성이 높아지고 오류 가능성은 낮아진다.

<br />

지역변수의 범위를 줄이는 가장 강력한 기법은 '맨 처음 쓰일 때 선언하기'다. 사용하려면 멀었는데 미리 선언부터 해두면 코드가 어수선해져 가독성이 떨어진다. 변수를 실제로 사용하는 시점엔 타입과 초기값이 기억나지 않을 수도 있다.

<br />

지역변수를 생각 없이 선언하다 보면 변수가 쓰이는 범위보다 너무 앞서 선언하거나, 다 쓴 뒤에도 여전히 살아 있게 되기 쉽다. 지역변수의 범위는 선언된 지점부터 그 지점을 포함한 블록이 끝날 때까지이므로, 실제 사용하는 블록 바깥에 선언된 변수는 그 블록이 끝난 뒤까지 살아 있게 된다. 그래서 실수로 의도한 범위 앞 혹은 뒤에서 그 변수를 사용하면 끔찍한 결과로 이어질 수 있다.

또한 거의 모든 지역변수는 선언과 동시에 초기화해야 한다. 초기화에 필요한 정보가 충분하지 않다면 충분해질 때까지 선언을 미뤄야 한다. `try-catch` 문은 이 규칙에서 예외다. 변수를 초기화하는 표현식에서 검사 예외를 던질 가능성이 있다면 `try` 블록 안에서 초기화해야 한다(그렇지 않으면 예외가 블록을 넘어 메서드에까지 전파된다). 다만 변수 값을 `try` 블록 바깥에서도 사용해야 한다면 `try` 블록 앞에서 선언해야 한다.

<br />

반복문은 독특한 방식으로 변수 범위를 최소화해 준다. 예전의 `for` 형태든 새로운 `for-each` 형태든, 반복문에서는 반복 변수의 범위가 반복문의 몸체, 그리고 `for` 키워드와 몸체 사이의 괄호 안으로 제한된다. 따라서 반복 변수의 값을 반복문이 종료된 뒤에도 써야 하는 상황이 아니라면 `while` 문보다는 `for` 문을 쓰는 편이 낫다.

``` java
// 컬렉션이나 배열을 순회하는 권장 관용구
for (Element e : c) {
    ... // e로 무언가를 한다.
}

// 반복자가 필요할 때의 관용구
for (Iterator<Element> i = c.iterator(); i.hasNext(); ) {
    Element e = i.next();
    ... // e와 i로 무언가를 한다.
}
```

```java
// while문을 사용 - 권장하지 않음!
Iterator<Element> i = c.iterator();
while(i.hasNext()) {
    doSomething(i.next());
}
...
    
Iterator<Element> i2 = c2.iterator();
while(i.hasNext()) { // 버그!
    doSomethingElse(i2.next);
}
```

<br />

지역변수 범위를 최소화하는 마지막 방법은 메서드를 작게 유지하고 한 가지 기능에 집중하는 것이다. 한 메서드에서 여러 가지 기능을 처리한다면 그중 한 기능과만 관련된 지역변수라도 다른 기능을 수행하는 코드에서 접근할 수 있을 것이다.